# BlackBoard/helm/values.yaml
# Darwin Blackboard (Brain) Helm values

# =============================================================================
# Brain Container Configuration
# =============================================================================

image:
  repository: ghcr.io/the-darwin-project/blackboard
  tag: "744fd79" # Updated by CI to commit SHA
  pullPolicy: IfNotPresent

replicaCount: 1

# =============================================================================
# Redis Sidecar Configuration (registry.redhat.io/rhel9/redis-7)
# =============================================================================

redis:
  enabled: true
  image:
    repository: registry.redhat.io/rhel9/redis-7
    tag: "latest"
  password: "darwin-brain" # Override via secret in production
  persistence:
    enabled: false # Set to true for production
    storageClassName: "" # e.g., ocs-storagecluster-cephfs
    size: 1Gi
  resources:
    requests:
      memory: 128Mi
      cpu: 50m
    limits:
      memory: 256Mi
      cpu: 200m

# =============================================================================
# GCP / Vertex AI Configuration
# =============================================================================

gcp:
  project: "" # Required: GCP project ID
  location: "us-central1"
  models:
    pro: "gemini-3-pro-preview"
    flash: "gemini-3-flash-preview"
  # Service account JSON can be mounted via secret
  # Set existingSecret to use a pre-created secret
  existingSecret: ""

# =============================================================================
# Service Configuration
# =============================================================================

service:
  type: ClusterIP
  port: 8000

# =============================================================================
# Route Configuration (OpenShift)
# =============================================================================

route:
  enabled: true
  # host: darwin-brain.apps.example.com  # Leave empty for auto-generated
  annotations: {}
  tls:
    enabled: true
    termination: edge # edge, passthrough, or reencrypt
    insecureEdgeTerminationPolicy: Redirect # Allow, Redirect, or None

# =============================================================================
# Application Metadata
# =============================================================================

app:
  name: "darwin-brain"
  version: "1.0.0"
  debug: false

# =============================================================================
# SysAdmin Agent Configuration
# =============================================================================

sysadmin:
  dryRun: true # Set to false in production
  autoApprove: false # DANGEROUS: Set to true only in trusted environments
  gitRepoPath: "/tmp/darwin-gitops"

# =============================================================================
# Resource Limits
# =============================================================================

resources:
  requests:
    memory: 256Mi
    cpu: 100m
  limits:
    memory: 512Mi
    cpu: 500m

# =============================================================================
# Security Context (OpenShift compatible)
# =============================================================================

podSecurityContext:
  fsGroup: 1001

securityContext:
  runAsNonRoot: true
  # OpenShift assigns arbitrary UID from namespace range
  # Do NOT set runAsUser - let OpenShift assign it
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false # App needs /tmp
  capabilities:
    drop:
      - ALL

# =============================================================================
# Probes
# =============================================================================

livenessProbe:
  httpGet:
    path: /
    port: 8000
  initialDelaySeconds: 10
  periodSeconds: 30
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /
    port: 8000
  initialDelaySeconds: 5
  periodSeconds: 10
  failureThreshold: 3

# =============================================================================
# Node Selection (optional)
# =============================================================================

nodeSelector: {}
tolerations: []
affinity: {}
